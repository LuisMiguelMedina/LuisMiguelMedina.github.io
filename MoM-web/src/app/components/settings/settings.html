<div class="settings-container">
    <!-- Header -->
    <div class="settings-header">
        <div class="header-info">
            <h1><i class="fas fa-cog me-2"></i>Configuración</h1>
            <p class="header-subtitle">Configurar parámetros del Servidor Dimensión-2</p>
        </div>
        <div class="header-actions">
            <button class="settings-btn secondary" (click)="resetToDefaults()" [disabled]="isSaving">
                <i class="fas fa-undo"></i>
                Restablecer
            </button>
            <button class="settings-btn primary" (click)="saveSettings()" [disabled]="isSaving">
                @if (isSaving) {
                <i class="fas fa-spinner fa-spin"></i>
                Guardando...
                } @else {
                <i class="fas fa-save"></i>
                Guardar Cambios
                }
            </button>
        </div>
    </div>

    @if (saveSuccess) {
    <div class="save-notification">
        <i class="fas fa-check-circle"></i>
        Configuración guardada correctamente
    </div>
    }

    <!-- Tabs -->
    <div class="settings-tabs">
        <button class="tab-btn" [class.active]="activeTab === 'server'" (click)="switchTab('server')">
            <i class="fas fa-server"></i>
            Servidor
        </button>
        <button class="tab-btn" [class.active]="activeTab === 'notifications'" (click)="switchTab('notifications')">
            <i class="fas fa-bell"></i>
            Notificaciones
        </button>
        <button class="tab-btn" [class.active]="activeTab === 'security'" (click)="switchTab('security')">
            <i class="fas fa-shield-alt"></i>
            Seguridad
        </button>
        @if (adminLevel() >= 3) {
        <button class="tab-btn" [class.active]="activeTab === 'advanced'" (click)="switchTab('advanced')">
            <i class="fas fa-flask"></i>
            Avanzado
        </button>
        }
    </div>

    <!-- Server Tab -->
    @if (activeTab === 'server') {
    <div class="settings-panel">
        <div class="panel-section">
            <h3 class="section-title">Configuración General</h3>

            <div class="setting-item">
                <div class="setting-info">
                    <label>Nombre del Servidor</label>
                    <span class="setting-desc">Nombre visible del servidor</span>
                </div>
                <input type="text" class="setting-input" [(ngModel)]="serverSettings.serverName">
            </div>

            <div class="setting-item">
                <div class="setting-info">
                    <label>Máx. Agentes</label>
                    <span class="setting-desc">Número máximo de agentes registrados</span>
                </div>
                <input type="number" class="setting-input small" [(ngModel)]="serverSettings.maxAgents" min="1"
                    max="1000">
            </div>

            <div class="setting-item">
                <div class="setting-info">
                    <label>Intervalo de Auto-Guardado</label>
                    <span class="setting-desc">Segundos entre guardados automáticos</span>
                </div>
                <select class="setting-select" [(ngModel)]="serverSettings.autoSaveInterval">
                    <option [value]="60">1 minuto</option>
                    <option [value]="300">5 minutos</option>
                    <option [value]="600">10 minutos</option>
                    <option [value]="1800">30 minutos</option>
                </select>
            </div>
        </div>

        <div class="panel-section">
            <h3 class="section-title">Control Dimensional</h3>

            <div class="setting-item">
                <div class="setting-info">
                    <label>Sincronización Dimensional</label>
                    <span class="setting-desc">Habilitar sincronización entre dimensiones</span>
                </div>
                <label class="toggle-switch">
                    <input type="checkbox" [(ngModel)]="serverSettings.dimensionSyncEnabled">
                    <span class="toggle-slider"></span>
                </label>
            </div>

            <div class="setting-item">
                <div class="setting-info">
                    <label>Nivel de Detección de Anomalías</label>
                    <span class="setting-desc">Sensibilidad del sistema de detección de anomalías</span>
                </div>
                <select class="setting-select" [(ngModel)]="serverSettings.anomalyDetectionLevel">
                    <option value="low">Bajo</option>
                    <option value="medium">Medio</option>
                    <option value="high">Alto</option>
                </select>
            </div>

            <div class="setting-item">
                <div class="setting-info">
                    <label>Protocolo de Contención</label>
                    <span class="setting-desc">Habilitar contención automática para anomalías</span>
                </div>
                <label class="toggle-switch">
                    <input type="checkbox" [(ngModel)]="serverSettings.containmentProtocol">
                    <span class="toggle-slider"></span>
                </label>
            </div>
        </div>
    </div>
    }

    <!-- Notifications Tab -->
    @if (activeTab === 'notifications') {
    <div class="settings-panel">
        <div class="panel-section">
            <h3 class="section-title">Preferencias de Alertas</h3>

            <div class="setting-item">
                <div class="setting-info">
                    <label>Alertas por Correo</label>
                    <span class="setting-desc">Recibir alertas por correo electrónico</span>
                </div>
                <label class="toggle-switch">
                    <input type="checkbox" [(ngModel)]="notificationSettings.emailAlerts">
                    <span class="toggle-slider"></span>
                </label>
            </div>

            <div class="setting-item">
                <div class="setting-info">
                    <label>Alertas de Anomalías</label>
                    <span class="setting-desc">Notificar sobre anomalías dimensionales</span>
                </div>
                <label class="toggle-switch">
                    <input type="checkbox" [(ngModel)]="notificationSettings.anomalyAlerts">
                    <span class="toggle-slider"></span>
                </label>
            </div>

            <div class="setting-item">
                <div class="setting-info">
                    <label>Alertas de Seguridad</label>
                    <span class="setting-desc">Notificar sobre eventos de seguridad</span>
                </div>
                <label class="toggle-switch">
                    <input type="checkbox" [(ngModel)]="notificationSettings.securityAlerts">
                    <span class="toggle-slider"></span>
                </label>
            </div>

            <div class="setting-item">
                <div class="setting-info">
                    <label>Alertas de Rendimiento</label>
                    <span class="setting-desc">Notificar sobre problemas de rendimiento</span>
                </div>
                <label class="toggle-switch">
                    <input type="checkbox" [(ngModel)]="notificationSettings.performanceAlerts">
                    <span class="toggle-slider"></span>
                </label>
            </div>
        </div>
    </div>
    }

    <!-- Security Tab -->
    @if (activeTab === 'security') {
    <div class="settings-panel">
        <div class="panel-section">
            <h3 class="section-title">Configuración de Seguridad</h3>

            <div class="security-info">
                <div class="security-badge">
                    <i class="fas fa-lock"></i>
                    <span>Encriptación QUANTUM-256</span>
                </div>
                <p>Todas las conexiones están aseguradas con encriptación resistente a computación cuántica</p>
            </div>

            <div class="setting-item readonly">
                <div class="setting-info">
                    <label>Protocolo de Encriptación</label>
                    <span class="setting-desc">Estándar de encriptación actual</span>
                </div>
                <span class="setting-value">QUANTUM-256</span>
            </div>

            <div class="setting-item readonly">
                <div class="setting-info">
                    <label>Estado del Firewall</label>
                    <span class="setting-desc">Estado del firewall dimensional</span>
                </div>
                <span class="setting-value status-active">
                    <i class="fas fa-check-circle"></i> ACTIVO
                </span>
            </div>

            <div class="setting-item readonly">
                <div class="setting-info">
                    <label>Última Auditoría de Seguridad</label>
                    <span class="setting-desc">Escaneo integral más reciente</span>
                </div>
                <span class="setting-value">hace 6 horas</span>
            </div>
        </div>
    </div>
    }

    <!-- Advanced Tab (Level 3 only) -->
    @if (activeTab === 'advanced' && adminLevel() >= 3) {
    <div class="settings-panel">
        <div class="panel-section danger-zone">
            <h3 class="section-title">
                <i class="fas fa-exclamation-triangle"></i>
                Configuración Avanzada
            </h3>
            <p class="danger-warning">Estas configuraciones pueden afectar la estabilidad del servidor. Proceda con precaución.</p>

            <div class="setting-item">
                <div class="setting-info">
                    <label>Modo de Depuración</label>
                    <span class="setting-desc">Habilitar registro detallado y diagnósticos</span>
                </div>
                <label class="toggle-switch">
                    <input type="checkbox" [(ngModel)]="serverSettings.debugMode">
                    <span class="toggle-slider"></span>
                </label>
            </div>

            <div class="setting-item">
                <div class="setting-info">
                    <label>Modo de Mantenimiento</label>
                    <span class="setting-desc">Poner servidor en modo de mantenimiento</span>
                </div>
                <label class="toggle-switch danger">
                    <input type="checkbox" [(ngModel)]="serverSettings.maintenanceMode">
                    <span class="toggle-slider"></span>
                </label>
            </div>
        </div>
    </div>
    }
</div>