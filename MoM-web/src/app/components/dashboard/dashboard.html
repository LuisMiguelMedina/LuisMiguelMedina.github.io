<!-- Matrix Dashboard Header -->
<div class="matrix-page-header">
  <div class="header-title">
    <h3>Dashboard</h3>
    @if (adminSession()) {
    <div class="welcome-text">> Bienvenido, {{ adminSession()?.name }}</div>
    }
    @if (onlineUsers() > 0) {
    <div class="online-status">
      <i class="fas fa-circle"></i>
      {{ onlineUsers() }} usuarios en línea
    </div>
    }
  </div>
  <div class="header-actions">
    <button class="matrix-btn" type="button">
      <i class="fas fa-download"></i>Generate Report
    </button>
  </div>
</div>

<!-- Stats Cards Row -->
<div class="row mb-4">
  <!-- Earnings (Monthly) Card -->
  <div class="col-md-6 col-xl-3 mb-4">
    <div class="matrix-card card-cyan">
      <div class="card-body">
        <div class="row g-0 align-items-center">
          <div class="col me-2">
            <div class="card-label">Earnings (Monthly)</div>
            <div class="card-value">
              @if (dashboardData()) {
              ${{ dashboardData()?.revenue | number:'1.0-0' }}
              } @else {
              <span style="color: var(--terminal-gray); font-size: 1rem;">Loading...</span>
              }
            </div>
          </div>
          <div class="col-auto">
            <i class="fas fa-calendar card-icon"></i>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Earnings (Annual) Card -->
  <div class="col-md-6 col-xl-3 mb-4">
    <div class="matrix-card card-green">
      <div class="card-body">
        <div class="row g-0 align-items-center">
          <div class="col me-2">
            <div class="card-label">Earnings (Annual)</div>
            <div class="card-value value-green">
              @if (dashboardData() && dashboardData()!.revenue) {
              ${{ (dashboardData()!.revenue * 5) | number:'1.0-0' }}
              } @else {
              <span style="color: var(--terminal-gray); font-size: 1rem;">Loading...</span>
              }
            </div>
          </div>
          <div class="col-auto">
            <i class="fas fa-dollar-sign card-icon"></i>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Tasks Card -->
  <div class="col-md-6 col-xl-3 mb-4">
    <div class="matrix-card card-amber">
      <div class="card-body">
        <div class="row g-0 align-items-center">
          <div class="col me-2">
            <div class="card-label">Tasks Progress</div>
            <div class="d-flex align-items-center">
              <div class="card-value value-amber me-3">
                @if (dashboardData()) {
                {{ dashboardData()!.growth }}%
                } @else {
                --
                }
              </div>
              <div class="flex-grow-1">
                <div class="matrix-progress progress progress-sm">
                  @if (dashboardData()) {
                  <div class="progress-bar" [style.width.%]="dashboardData()!.growth"
                    [attr.aria-valuenow]="dashboardData()!.growth" aria-valuemin="0" aria-valuemax="100">
                  </div>
                  }
                </div>
              </div>
            </div>
          </div>
          <div class="col-auto">
            <i class="fas fa-clipboard-list card-icon"></i>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Sessions Card -->
  <div class="col-md-6 col-xl-3 mb-4">
    <div class="matrix-card card-purple">
      <div class="card-body">
        <div class="row g-0 align-items-center">
          <div class="col me-2">
            <div class="card-label">Active Sessions</div>
            <div class="card-value value-purple">
              @if (dashboardData()) {
              {{ dashboardData()!.sessions }}
              } @else {
              --
              }
            </div>
          </div>
          <div class="col-auto">
            <i class="fas fa-users card-icon"></i>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Charts Row -->
<div class="row mb-4">
  <!-- Area Chart -->
  <div class="col-lg-7 col-xl-8 mb-4">
    <div class="matrix-chart-container">
      <div class="chart-header">
        <h6>Earnings Overview</h6>
        <div class="dropdown">
          <button class="matrix-btn" style="padding: 0.25rem 0.5rem; font-size: 0.75rem;" type="button"
            data-bs-toggle="dropdown">
            <i class="fas fa-ellipsis-v"></i>
          </button>
          <div class="dropdown-menu dropdown-menu-end">
            <a class="dropdown-item" href="#">View Details</a>
            <a class="dropdown-item" href="#">Export Data</a>
          </div>
        </div>
      </div>
      <div class="chart-placeholder">
        <i class="fas fa-chart-area"></i>
        <p>[ CHART_AREA: EARNINGS_OVERVIEW ]</p>
        <small style="color: var(--terminal-gray);">Using Chart.js or similar library</small>
      </div>
    </div>
  </div>

  <!-- Pie Chart -->
  <div class="col-lg-5 col-xl-4 mb-4">
    <div class="matrix-chart-container">
      <div class="chart-header">
        <h6>Revenue Sources</h6>
        <div class="dropdown">
          <button class="matrix-btn" style="padding: 0.25rem 0.5rem; font-size: 0.75rem;" type="button"
            data-bs-toggle="dropdown">
            <i class="fas fa-ellipsis-v"></i>
          </button>
          <div class="dropdown-menu dropdown-menu-end">
            <a class="dropdown-item" href="#">View Details</a>
            <a class="dropdown-item" href="#">Export Data</a>
          </div>
        </div>
      </div>
      <div class="chart-placeholder" style="min-height: 180px;">
        <i class="fas fa-chart-pie"></i>
        <p>[ CHART_PIE: REVENUE_SOURCES ]</p>
      </div>
      <div class="d-flex justify-content-center gap-3 mt-3"
        style="font-family: var(--font-terminal); font-size: 0.8rem;">
        <span style="color: var(--terminal-cyan);">
          <i class="fas fa-circle me-1"></i> Direct
        </span>
        <span style="color: var(--terminal-green);">
          <i class="fas fa-circle me-1"></i> Social
        </span>
        <span style="color: var(--terminal-amber);">
          <i class="fas fa-circle me-1"></i> Referral
        </span>
      </div>
    </div>
  </div>
</div>

<!-- Activity Section - Only for Level 2+ -->
@if (adminLevel() >= 2) {
<div class="row">
  <div class="col-lg-6 mb-4">
    <div class="matrix-chart-container">
      <div class="chart-header">
        <h6>Recent Activity</h6>
      </div>
      <div class="matrix-timeline">
        @for (activity of recentActivity; track activity.timestamp) {
        <div class="timeline-item">
          <div class="timeline-icon">
            <i class="fas fa-file-alt"></i>
          </div>
          <div class="timeline-content">
            <div class="timeline-time">{{ activity.timestamp | date:'short' }}</div>
            <div class="timeline-text">{{ activity.description }}</div>
          </div>
        </div>
        }
      </div>
    </div>
  </div>

  <!-- System Status - Only for Level 3 -->
  @if (adminLevel() >= 3) {
  <div class="col-lg-6 mb-4">
    <div class="matrix-chart-container">
      <div class="chart-header">
        <h6>System Status</h6>
      </div>
      <div class="p-3">
        <div class="d-flex justify-content-between align-items-center mb-3" style="font-family: var(--font-terminal);">
          <span style="color: var(--terminal-gray);">CPU_USAGE:</span>
          <span style="color: var(--terminal-green);">42%</span>
        </div>
        <div class="matrix-progress progress mb-4" style="height: 8px;">
          <div class="progress-bar" style="width: 42%;"></div>
        </div>

        <div class="d-flex justify-content-between align-items-center mb-3" style="font-family: var(--font-terminal);">
          <span style="color: var(--terminal-gray);">MEMORY_USAGE:</span>
          <span style="color: var(--terminal-amber);">68%</span>
        </div>
        <div class="matrix-progress progress mb-4" style="height: 8px;">
          <div class="progress-bar"
            style="width: 68%; background: linear-gradient(90deg, var(--terminal-amber), var(--terminal-red)) !important;">
          </div>
        </div>

        <div class="d-flex justify-content-between align-items-center mb-3" style="font-family: var(--font-terminal);">
          <span style="color: var(--terminal-gray);">DISK_USAGE:</span>
          <span style="color: var(--terminal-cyan);">35%</span>
        </div>
        <div class="matrix-progress progress mb-4" style="height: 8px;">
          <div class="progress-bar" style="width: 35%;"></div>
        </div>

        <div class="d-flex justify-content-between align-items-center" style="font-family: var(--font-terminal);">
          <span style="color: var(--terminal-gray);">NETWORK_STATUS:</span>
          <span style="color: var(--terminal-green);">
            <i class="fas fa-circle me-1" style="font-size: 0.5rem;"></i> ONLINE
          </span>
        </div>
      </div>
    </div>
  </div>
  }
</div>
} @else {
<!-- Restricted message for Level 1 -->
<div class="row">
  <div class="col-12">
    <div class="matrix-chart-container text-center" style="padding: 3rem;">
      <i class="fas fa-lock" style="font-size: 3rem; color: var(--terminal-gray); margin-bottom: 1rem;"></i>
      <p style="font-family: var(--font-terminal); color: var(--terminal-gray); letter-spacing: 2px;">
        [ NIVEL DE ACCESO INSUFICIENTE ]
      </p>
      <small style="color: var(--terminal-cyan-dim);">
        Actividades y métricas avanzadas requieren nivel 2 o superior
      </small>
    </div>
  </div>
</div>
}